@ENEMYDECK_CHECK(캐릭터_ID)
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC モン用덱_ID
#DIM DYNAMIC 캐릭터_설정덱
SIF 캐릭터_ID == -1
	RETURN 0
;개편덱확인（CFLAG:729)：最低限덱として成立しているという플래그설정
SIF CFLAG:캐릭터_ID:개편덱확인 >= 1
	RETURN 100


VARSET RESULT
VARSET RESULTS



CALL MONSTER_DECK(캐릭터_ID)
モン用덱_ID = RESULT

IF モン用덱_ID >= 1
	TRYCALLFORM DUELDECK_{モン用덱_ID}("存在確認")
	RESULTS:1 = %RESULTS%
	RETURN モン用덱_ID
ENDIF

TRYCALLFORM DUELDECK_{NO:캐릭터_ID}("存在確認")
IF RESULT == 1
	RESULTS:1 = %RESULTS%
	RETURN NO:캐릭터_ID
ENDIF

RETURN 0

@MONSTER_DECK(캐릭터_ID)
#DIM DYNAMIC 캐릭터_ID
#DIM DYNAMIC モン用덱_ID 
#DIM DYNAMIC 캐릭터_설정덱

SELECTCASE NO:캐릭터_ID
;ディアベル
CASE 1920
	モン用덱_ID = 10010
;龍仙女さん
CASE 1630
	モン用덱_ID = 10015
;ガイドさん
CASE 1310
	モン用덱_ID = 10016
;물遣いさん
CASE 2241
	モン用덱_ID = 10026		
;ヒュプノシスター
CASE 1606
	モン用덱_ID = 10027
;매지션 걸、サイマジ
CASE 1000, 1010
	モン用덱_ID = 10002
CASE 1003 to 1007
	モン用덱_ID = 10002
;충혹마
CASE 1370 to 1385
	モン用덱_ID = 10003
;드래곤메이드
CASE 2055 to 2060
	モン用덱_ID = 10004
;령사
CASE 1250 to 1255
	モン用덱_ID = 10005
;Evil☆Twin
CASE 2075 to 2080
	モン用덱_ID = 10006
;마돌체
CASE 1340 to 1346
	モン用덱_ID = 10007
;エリスさんと엑소시스터ズ
CASE 2100 to 2104
	モン用덱_ID = 10008
;가스타
CASE 1815 to 1819
	モン用덱_ID = 10009
;아로마ージ
CASE 1390 to 1399
	モン用덱_ID = 10011
;푸른 눈
CASE 1020
	モン用덱_ID = 10012
;라뷰린스
CASE 2110, 2113
モン用덱_ID = 10013
;라뷰린스2
CASE 2111, 2112
モン用덱_ID = 20010
;드래그마
CASE 1888
	モン用덱_ID = 10019
;다이놀피어
CASE 1325,1326
	モン用덱_ID = 10020
;섀도르
CASE 1830 to 1833
	モン用덱_ID = 10023
;섬도희
CASE 2000 to 2003
	モン用덱_ID = 10024
;아마조네스
CASE 1030 to 1034
	モン用덱_ID = 1030
;墓守
CASE 1045 to 1048
	モン用덱_ID = 1045
;하얀 森
CASE 1931 to 1933
	モン用덱_ID = 1930
;센츄리온
CASE 2131, 2132
	モン用덱_ID = 2130
;바르모니카
CASE 2141, 2142
	モン用덱_ID = 2140
;LL
CASE 1170
	モン用덱_ID = 2562
;해피
CASE 1055 to 1057
	モン用덱_ID = 2502
;환주
CASE 1151
	モン用덱_ID = 2560
;月光
CASE 1155, 1156, 1056, 1162, 1164
	モン用덱_ID = 2561
;마린세스
CASE 1210 to 1222
	モン用덱_ID = 2575
;붉은 눈
CASE 8000
	モン用덱_ID = 2503
;イシズティアラ
CASE 1950 to 1953
	モン用덱_ID = 2501
;네무렐리아
CASE 1350
	モン用덱_ID = 2664
;순성
CASE 1406
	モン用덱_ID = 1405
;ダイスキー
CASE 2350 to 2356
	モン用덱_ID = 2686
;왈큐레
CASE 1063 to 1070
	モン用덱_ID = 1062
;고스트릭
CASE 1356 to 1361
	モン用덱_ID = 1355
;아로마
CASE 1391 to 1399
	モン用덱_ID = 1390
;몽마경
CASE 1411 to 1415
	モン用덱_ID = 1410
;뇌화
CASE 1436
	モン用덱_ID = 1435
;破械
CASE 1441 to 1442
	モン用덱_ID = 1440
;네프티스
CASE 2036 to 2039
	モン用덱_ID = 2035
;ウィッチクラフト
CASE 2041 to 2047
	モン用덱_ID = 2040
;도레미코드
CASE 2086 to 2093
	モン用덱_ID = 2085
;미캉코
CASE 2121 to 2124
	モン用덱_ID = 2120
;육화
CASE 2151 to 2160
	モン用덱_ID = 2150
;M∀LICE
CASE 2171 to 2176
	モン用덱_ID = 2170
;엑스큐티
CASE 2362 to 2370
	モン用덱_ID = 2361
;라바르
CASE 1825 to 1827
	モン用덱_ID = 2660
;뱀파이어
CASE 2020 to 2024
	モン用덱_ID = 2519

;리추어
CASE 1811 to 1813
	モン用덱_ID = 1810
;십이수
CASE 1851 to 1857
	モン用덱_ID = 1850
;트라이브리게이드
CASE 1890 to 1891
	モン用덱_ID = 2517
;포츈 레이디
CASE 1080 to 1087
	モン用덱_ID = 2532
;페어리테일＋령사
CASE 1281 to 1284
	モン用덱_ID = 1280
;라이트로드
CASE 1400 to 1402
	モン用덱_ID = 2659
;マギストス
CASE 2048 to 2049
	モン用덱_ID = 2663
;파라디온
CASE 1874 to 1875
	モン用덱_ID = 2688
;CASE 2231
;	モン用덱_ID = 2231

CASE 2230 to 2233
	モン用덱_ID = 10074
;サリア
CASE 4300
	モン用덱_ID = 4300
;コッコ・ルピコ
CASE 2753
	モン用덱_ID = 2753
;P.U.N.K
CASE 2210 to 2211
	モン用덱_ID = 2210
;S-Force
CASE 1320 to 1321
	モン用덱_ID = 10065
;マスカレ
CASE 1335
	モン用덱_ID = 10068
;마요괴
CASE 2031 to 2032
	モン用덱_ID = 2030
;누밸즈
CASE 2261
	モン用덱_ID = 2260
;ダピコ
CASE 2757
	モン用덱_ID = 2757
;ドラゴン娘
CASE 4000 to 4004
	モン用덱_ID = 4000
;デス퍼핏、アダムスキー
CASE 4010,4011,4012,4013,4014,4015,4052
	モン用덱_ID = 4010
;제니스・セレス、ウェディング、無垢の守護者カノン
CASE 4020,4021,4022,4023,4023,4025,2758
	モン用덱_ID = 4020
;Q.E.D.
CASE 4051
	モン用덱_ID = 4051
;VV─8、Vol-Val-8
CASE 4065, 4071
	モン用덱_ID = 4065
;마술사
CASE 1130 to 1132
	モン用덱_ID = 1130
;마계극단
CASE 1190 to 1193
	モン用덱_ID = 1190
;손패誘発少女
CASE 1260 to 1265
	モン用덱_ID = 1260
;천후
CASE 2015 to 2018
	モン用덱_ID = 2015
;ドラグナー
CASE 4080 to 4083
	モン用덱_ID = 4080
	;AL유니온
CASE 4901 to 4919
	モン用덱_ID = 4900
;AL鉄血
CASE 4921 to 4939
	モン用덱_ID = 4920
;AL重桜
CASE 4941 to 4959
	モン用덱_ID = 4940
;AL重桜
CASE 4941 to 4959
	モン用덱_ID = 4940
;ALロイヤル
CASE 4961 to 4979
	モン用덱_ID = 4960
ENDSELECT
;；PRINTFORML 초기설정 덱:{CFLAG:캐릭터_ID:초기설정덱}
IF CFLAG:캐릭터_ID:초기설정덱 >= 1
	モン用덱_ID = CFLAG:캐릭터_ID:초기설정덱
ENDIF
IF CFLAG:캐릭터_ID:설정덱 >= 1
	캐릭터_설정덱 = CFLAG:캐릭터_ID:설정덱 - 1
	CALL DECK_ABLE_CHECK(캐릭터_설정덱)
	SIF RESULT != 0
		モン用덱_ID = 캐릭터_설정덱
ENDIF

RETURN モン用덱_ID



@DUELDECK_CFLAG(듀얼리스트,캐릭터_ID)
#DIM DYNAMIC 캐릭터_ID
#DIMS DYNAMIC 듀얼리스트
#DIM DYNAMIC カウンタ

;덱설정
FOR カウンタ,700,750
	SIF CFLAG:캐릭터_ID:カウンタ <= 0
		CONTINUE
	IF カウンタ == 700
		SETVAR @"%듀얼리스트%_덱:POOL_COUNT(1)", CFLAG:캐릭터_ID:カウンタ
	ELSE
		SETVAR @"%듀얼리스트%_덱:POOL_COUNT(0)", CFLAG:캐릭터_ID:カウンタ
	ENDIF
NEXT
;EX덱설정
FOR カウンタ,770,790
	SIF CFLAG:캐릭터_ID:カウンタ <= 0
		CONTINUE
	IF カウンタ == 770
		SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(1)", CFLAG:캐릭터_ID:カウンタ
	ELSE
		SETVAR @"%듀얼리스트%_EX덱:POOL_COUNT(0)", CFLAG:캐릭터_ID:カウンタ
	ENDIF
NEXT


;Anonym추가
@ENEMY_DECK_AUTO_MAKE(캐릭터番号,설정플래그)
#DIM DYNAMIC 캐릭터番号
#DIM DYNAMIC 캐릭터ID
#DIMS DYNAMIC 지정カテゴリ
#DIMS DYNAMIC 듀얼리스트
#DIM DYNAMIC カウンタ
#DIM DYNAMIC カウンタB
#DIM DYNAMIC カード_ID
#DIM DYNAMIC カウンタDeck
#DIM DYNAMIC カウンタEXDeck
#DIM DYNAMIC カード枚数チェック,999999
#DIM DYNAMIC リピート횟수
#DIM DYNAMIC 설정カード종류
#DIM DYNAMIC 설정플래그
#DIM DYNAMIC ERA플래그
VARSET カード_ID


IF 설정플래그 == 0
;대상が모브ならNGを返す
	SIF 캐릭터番号 <= 0
		RETURN 0
	;개편덱확인（CFLAG:729)：最低限덱として成立しているという플래그설정
	SIF CFLAG:캐릭터番号:개편덱확인 >= 1
		RETURN 100
	캐릭터ID = NO:캐릭터番号
	TRYCALLFORM CARDNAME_{캐릭터ID}("カテゴリ")
	지정カテゴリ = %RESULTS:0%
	SIF GROUPMATCH(지정カテゴリ,"없음","E.R.A","듀얼리스트")
		RETURN 0
ELSE
	캐릭터ID = 캐릭터番号
	TRYCALLFORM CARDNAME_{캐릭터ID}("カテゴリ")
	지정カテゴリ = %RESULTS:0%
	SIF MATCH(RESULTS,"E.R.A")
		ERA플래그 = 1
	SIF GROUPMATCH(지정カテゴリ,"없음","듀얼리스트")
		RETURN 0
ENDIF

;カウンタDeck = 700
;대상캐릭터のカテゴリをチェック。なし、ERA、듀얼리스트はNG


;덱の空きをちゃんと-1につぶす
VARSET 仮組_덱,-1
VARSET 仮組_EX덱,-1


FOR カード_ID,1000,100000
	;名前のない＝存在しない番号はスキップ
	TRYCALLFORM CARDNAME_{カード_ID}("名前")
	SIF RESULTS == ""
		CONTINUE
	;EX덱カードはスキップ
	TRYCALLFORM CARD_{カード_ID}("종류")
	SIF INRANGE(RESULT,4,10)
		CONTINUE
	
	;トークンはスキップ
	TRYCALLFORM CARD_{カード_ID}("トークン")
	SIF RESULT == 1
		CONTINUE
	IF ERA플래그 == 0
		;ERAカードはスキップ
		TRYCALLFORM CARDNAME_{カード_ID}("カテゴリ")
		SIF MATCH(RESULTS,"E.R.A")
			CONTINUE
	ENDIF
	;同じカテゴリを持たないカードはスキップ
	TRYCALLFORM CARDNAME_{カード_ID}("カテゴリ")
	SIF !MATCH(RESULTS,지정カテゴリ)
		CONTINUE
	;종류で入れる枚数を決める
	VARSET 설정カード종류
	TRYCALLFORM CARD_{カード_ID}("종류")
	설정カード종류 = RESULT
	SELECTCASE 설정カード종류
	CASE 1 to 10
		リピート횟수 = 3
	CASE 20 to 29
		IF GROUPMATCH(설정カード종류,지속마법, 速攻마법)
			リピート횟수 = 2
		ELSEIF RESULT == 装備마법 
			リピート횟수 = 1
		ELSE
			リピート횟수 = 3		
		ENDIF
	CASE 30 to 39
		リピート횟수 = 1
	ENDSELECT
	;덱관리用CFLAGに入れる＆;덱枠を＋＆덱に入れたカード数を＋판정、を３回

	FOR カウンタB,0,リピート횟수
		SIF カード枚数チェック:カード_ID >= 3
			BREAK
;		CFLAG:캐릭터番号:カウンタDeck = カード_ID
		仮組_덱:カウンタDeck = カード_ID
		カウンタDeck ++
		カード枚数チェック:カード_ID ++
	SIF カウンタDeck > 49 ;改덱確認=729
			BREAK
	NEXT
	SIF カウンタDeck > 49 ;改덱確認=729
		BREAK
	[SKIPSTART]
		CFLAG:캐릭터番号:カウンタDeck = カード_ID
		カウンタDeck ++
		カード枚数チェック:カード_ID ++
		
		;TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタDeck-700}枚目、%RESULTS%、덱in
		;50枚になったら終了

		SIF カウンタDeck > 749 ;改덱確認=729
			BREAK

		CFLAG:캐릭터番号:カウンタDeck = カード_ID
		カウンタDeck ++
		カード枚数チェック:カード_ID ++
		
		;TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタDeck-700}枚目、%RESULTS%、덱in
		;50枚になったら終了
		SIF カウンタDeck > 749 ;改덱確認=729
			BREAK


		CFLAG:캐릭터番号:カウンタDeck = カード_ID
		カウンタDeck ++
		カード枚数チェック:カード_ID ++
		
		;TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタDeck-700}枚目、%RESULTS%、덱in
		;50枚になったら終了
		SIF カウンタDeck > 749 ;改덱確認=729
			BREAK
	[SKIPEND]
NEXT


;덱が30枚になってない場合
IF 仮組_덱:29 <= 0
	;まずうらら
;	カウンタDeck = 700
;	FOR カウンタDeck,700,730
	FOR カウンタDeck,0,30
		;既にカードが入った枠はスキップ
;		SIF CFLAG:캐릭터番号:カウンタDeck > 0
;			CONTINUE
		SIF 仮組_덱:カウンタDeck > 0
			CONTINUE

		;うらら（3枚）
		IF カード枚数チェック:1263 < 3
			;うららin
;			CFLAG:캐릭터番号:カウンタDeck = 1263
			仮組_덱:カウンタDeck = 1263
			;덱に入れたカード数を＋판정
			カード枚数チェック:1263 ++
			;덱枠を＋
		;サンボル（1枚）
		ELSEIF カード枚数チェック:70003 < 1
			;サンボルin
			仮組_덱:カウンタDeck = 70003
			カード枚数チェック:70003 ++
		;無限泡影（3枚）
		ELSEIF カード枚数チェック:90100 < 3
			仮組_덱:カウンタDeck = 90100
			カード枚数チェック:90100 ++
		;날개帚（1枚）
		ELSEIF カード枚数チェック:70004 < 1
			仮組_덱:カウンタDeck = 70004
			カード枚数チェック:70004 ++
		;墓穴の指名者（2枚）
		ELSEIF カード枚数チェック:70100 < 2
			仮組_덱:カウンタDeck = 70100
			カード枚数チェック:70100 ++
		;わらし（2枚）
		ELSEIF カード枚数チェック:1262 < 2
			仮組_덱:カウンタDeck = 1262
			カード枚数チェック:1262 ++
		;うさぎ（2枚）
		ELSEIF カード枚数チェック:1260 < 2
			仮組_덱:カウンタDeck = 1260
			カード枚数チェック:1260 ++
		;大嵐（1枚）
		ELSEIF カード枚数チェック:70005 < 1
			仮組_덱:カウンタDeck = 70005
			カード枚数チェック:70005 ++
		;死者蘇生（1枚）
		ELSEIF カード枚数チェック:70001 < 1
			仮組_덱:カウンタDeck = 70001
			カード枚数チェック:70001 ++

		;禁じられた一滴（2枚）
		ELSEIF カード枚数チェック:70115 < 2
			仮組_덱:カウンタDeck = 70115
			カード枚数チェック:70115 ++
		;神の宣告（2枚）
		ELSEIF カード枚数チェック:90500 < 2
			仮組_덱:カウンタDeck = 90500
			カード枚数チェック:90500 ++
		;神の宣告（2枚）
		ELSEIF カード枚数チェック:90501 < 2
			仮組_덱:カウンタDeck = 90501
			カード枚数チェック:90501 ++


		;ヴェーラー（3枚）
		ELSEIF カード枚数チェック:1095 < 3
			仮組_덱:カウンタDeck = 1095
			カード枚数チェック:1095 ++
		;DDクロウ（3枚）
		ELSEIF カード枚数チェック:26000 < 3
			仮組_덱:カウンタDeck = 26000
			カード枚数チェック:26000 ++
		;パンクラ（3枚）
		ELSEIF カード枚数チェック:27001 < 3
			仮組_덱:カウンタDeck = 27001
			カード枚数チェック:27001 ++
		ENDIF
		;30枚になったら終了
		SIF カウンタDeck > 29 ;改덱確認=729
			BREAK
	NEXT
	;ここまでやっても덱が30枚にならないならさじを投げてNGを返す
;	SIF CFLAG:캐릭터番号:改덱確認 == 0
	SIF 仮組_덱:29 == 0
		RETURN 0
ENDIF


;カウンタEXDeck = 770
FOR カード_ID,1000,100000
	;名前のない＝存在しない番号はスキップ
	TRYCALLFORM CARDNAME_{カード_ID}("名前")
	SIF RESULTS == ""
		CONTINUE
	;EX덱カードじゃないのはスキップ
	TRYCALLFORM CARD_{カード_ID}("종류")
	SIF !INRANGE(RESULT,4,10)
		CONTINUE
	;トークンはスキップ
	TRYCALLFORM CARD_{カード_ID}("トークン")
	SIF RESULT == 1
		CONTINUE
	IF ERA플래그 == 0
		;ERAカードはスキップ
		TRYCALLFORM CARDNAME_{カード_ID}("カテゴリ")
		SIF MATCH(RESULTS,"E.R.A")
			CONTINUE
	ENDIF
	;同じカテゴリを持たないカードはスキップ
	TRYCALLFORM CARDNAME_{カード_ID}("カテゴリ")
	SIF !MATCH(RESULTS,지정カテゴリ)
		CONTINUE
	FOR カウンタB,0,3
		SIF カード枚数チェック:カード_ID >= 3
			BREAK
		;CFLAG:캐릭터番号:カウンタEXDeck = カード_ID
		仮組_EX덱:カウンタEXDeck = カード_ID
		カウンタEXDeck ++
		カード枚数チェック:カード_ID ++
	NEXT

	[SKIPSTART]
		;덱관리用CFLAGに入れる＆;덱枠を＋＆덱に入れたカード数を＋판정、を３回
		CFLAG:캐릭터番号:カウンタEXDeck = カード_ID
		カウンタEXDeck ++
		カード枚数チェック:カード_ID ++
		TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタEXDeck-770}枚目、%RESULTS%、덱in
		SIF カウンタEXDeck >= 785
			BREAK
		CFLAG:캐릭터番号:カウンタEXDeck = カード_ID
		カウンタEXDeck ++
		カード枚数チェック:カード_ID ++
		TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタEXDeck-770}枚目、%RESULTS%、덱in
		SIF カウンタEXDeck >= 785
			BREAK
		CFLAG:캐릭터番号:カウンタEXDeck = カード_ID
		カウンタEXDeck ++
		カード枚数チェック:カード_ID ++
		TRYCALLFORM CARDNAME_{カード_ID}("名前")
		;PRINTFORML {カウンタEXDeck-770}枚目、%RESULTS%、덱in
	[SKIPEND]
	;15枚になったら終了
	SIF カウンタEXDeck >= 15
		BREAK
NEXT

;EX덱は特に15枚にならなくてもOK
;EX덱の空きをちゃんと-1につぶす
;FOR カウンタ,770,785
;	SIF CFLAG:캐릭터番号:カウンタ == 0
;		CFLAG:캐릭터番号:カウンタ = -1
;NEXT




;一旦덱中身をチェック、デバッグチェック用
; カウンタDeck = 700
; FOR カウンタDeck,700,750
; 	TRYCALLFORM CARDNAME_{CFLAG:캐릭터番号:カウンタDeck}("名前")
; 	SIF RESULTS != ""
; 	PRINTFORML [{カウンタDeck-699}] %RESULTS%
; 	RESULTS = ""
; NEXT
; カウンタEXDeck = 770
; FOR カウンタEXDeck,770,785
; 	SIF CFLAG:캐릭터番号:カウンタEXDeck <= 0
; 		CONTINUE
; 	TRYCALLFORM CARDNAME_{CFLAG:캐릭터番号:カウンタEXDeck}("名前")
; 	SIF RESULTS != ""
; 	PRINTFORML [{カウンタEXDeck-769}] %RESULTS%
; 	RESULTS = ""
; NEXT

IF 설정플래그 == 0
;	CALLFORM DUELDECK_CFLAG("仮組",캐릭터番号)

	FOR カウンタ,700,760
		CFLAG:캐릭터番号:カウンタ = -1
	NEXT
	FOR カウンタ,770,790
		CFLAG:캐릭터番号:カウンタ = -1
	NEXT

	FOR カウンタ,0,50
		CFLAG:캐릭터番号:(700 + カウンタ) = 仮組_덱:カウンタ
	NEXT
	FOR カウンタ,0,15
		CFLAG:캐릭터番号:(770 + カウンタ) = 仮組_EX덱:カウンタ
	NEXT

	RETURN 1
ELSE
	CALL CARD_DECK_CHECK(0,2,1)
	SIF RESULT == 1
		RETURN 0

	FOR カウンタ,0,50
		編集_덱:カウンタ = 仮組_덱:カウンタ
	NEXT
	FOR カウンタ,0,15
		編集_EX덱:カウンタ = 仮組_EX덱:カウンタ
	NEXT		
ENDIF

;無事ここまで来たらOKを返す
RETURN 1
